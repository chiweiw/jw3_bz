# 技能增长报告静态站点 使用说明

## 前提
- 已安装并可用的 `uv`（已包含在项目流程中）。
- 源数据文本（示例为项目根目录的 `1.txt`）。

## 一次性准备
- 在项目根目录执行依赖同步：
  - `uv sync`

## 更新数据流程
- 将新的技能原文文本放置到任意路径（本地 `txt`）。
- 在项目根目录执行构建命令：
  - `uv run skill-growth-report --input <源文本路径> --site-dir docs --db-path skill_report.db --jump-threshold 2.0`
- 说明：
  - `--input`：技能原文 `txt` 路径；默认 `1.txt`。
  - `--site-dir`：静态站点输出目录；默认 `docs`（用于 GitHub Pages）。
  - `--db-path`：SQLite 数据库文件路径；默认 `skill_report.db`。
  - `--jump-threshold`：跃迁判定阈值（与差值中位数比较）；默认 `2.0`。
- 执行成功后，会生成/覆盖以下文件：
  - `docs/data/skills.json`
  - `docs/data/series.json`
  - `docs/data/values.json`
  - `docs/data/analysis.json`
  - 以及静态页面与资产：`docs/index.html`、`docs/charts.html`、`docs/assets/*`、`docs/.nojekyll`
- SQLite 数据库将写入四张表并可供后续检查：
  - `skills`、`series`、`values_tbl`、`analysis`

## 打开网页
- 直接在资源管理器中双击：
  - `docs/index.html`（基础信息页：筛选、排序、展开级次值与差值）
  - `docs/charts.html`（图表页：折线/差值曲线、线性高亮、跃迁点标记）
- 或使用任意静态服务器（可选），例如：
  - 在 `docs/` 目录启动静态服务后，浏览器访问对应地址。

## 常见问题
- CDN 不可用：页面将自动回退加载本地 `assets/echarts.min.js`（如需离线运行，请将该文件放入 `报告站点/assets/`）。
- 数据为空或解析异常：
  - 确认源文本结构符合“`技能名 - 技能ID`”与序列格式（如 `<…>点XXX`、`<…>XXX伤害`）。
  - 可调整 `--jump-threshold` 以适配不同数据分布。
- Windows 本地离线可用：无需任何服务与权限配置，直接打开页面即可。

## 目录结构（输出）
- `docs/`
  - `.nojekyll`
  - `index.html`、`charts.html`
  - `assets/`（样式、脚本、可选本地图表库文件）
  - `data/skills.json`、`data/series.json`、`data/values.json`、`data/analysis.json`

## GitHub Pages 部署
- 在 GitHub 仓库设置中：`Settings -> Pages`
  - `Source` 选择 `Deploy from a branch`
  - `Branch` 选择 `main`，`Folder` 选择 `/docs`
- 保存后，GitHub Pages 将从 `docs/` 目录部署站点。

## 验证
- 检查 SQLite 表：
  - `uv run python -c "import sqlite3;print(sqlite3.connect('skill_report.db').execute('SELECT name FROM sqlite_master WHERE type=\'table\'').fetchall())"`
- 打开 `index.html` 与 `charts.html` 后确认页面是否正常加载与渲染。
